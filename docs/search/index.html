<!DOCTYPE html>
<html lang="ja" class="no-js">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>出涸らし闇ナベ</title>

  <script type="module">
    document.documentElement.classList.remove('no-js');
    document.documentElement.classList.add('js');
  </script>

  <link rel="stylesheet" href="https://degarashibanchi.github.io/style.css">

  <meta name="description" content="文芸風前会所属、出汁殻ニボシのウェブサイト。現在コンテンツ拡充中。"/>
  <meta property="og:title" content="出涸らし闇ナベ">
  <meta property="og:site_name" content="出涸らし闇ナベ">
  <meta property="og:description" content="文芸風前会所属、出汁殻ニボシのウェブサイト。現在コンテンツ拡充中。">
  <meta property="og:image" content="https://degarashibanchi.github.io//site_design/summary_large_image.png">
  <meta property="og:locale" content="ja_JP">
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">
  <meta property="og:url" content="https://degarashibanchi.github.io/">
  <link rel="canonical" href="https://degarashibanchi.github.io/">

  <link rel="icon" href="https://degarashibanchi.github.io/site_design/favicon.ico">
  <link rel="icon" href="https://degarashibanchi.github.io/site_design/favicon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="https://degarashibanchi.github.io/site_design/apple-touch-icon.png">
  <link rel="manifest" href="https://degarashibanchi.github.io/site_design/site.webmanifest">
  <meta name="theme-color" content="#444444">
</head>



 <body>

 

   <header>
   	<div class="header_logo">
      <a href="https://degarashibanchi.github.io/"><img src="https://degarashibanchi.github.io/site_design/design_banner_logo.png" style="height: 80px;"></a>
    </div>

     <div id="search-wrap">
       <form>
      <input id="searchKeyword" type="search" size="20" placeholder="検索">
      <input id="searchButton" type="submit" value="検索">
    </form>

    <script>
    const SEARCH_URL = '/search/';

    window.addEventListener('DOMContentLoaded', () => {
      const searchButton = document.getElementById('searchButton');
      const searchKeyword = document.getElementById('searchKeyword');

      
      searchButton.addEventListener('click', e => {
        e.preventDefault();  
        const query = searchKeyword.value;
        const url = query ? SEARCH_URL + '#' + query : SEARCH_URL;
        location.href = url;
      });
    });
    </script>
   	</div>
   </header>

   

    
<body>
<script src="data.js"></script>
<main>

<h1 style="margin-left:1rem">▼検索結果</h1>
<input id="query" onkeyup="location.replace('#' + this.value)" size="15" autocomplete="off" autofocus placeholder="検索ワード" style="margin-left:1em" />
<span id="inputWord"></span> <span id="resultCount"></span>
<div id="result"></div>

<script>
function search(query) {
  var result = searchData(query);
  var html = createHtml(result);
  showResult(html);
  showResultCount(result.length, data.length);
}

function searchData(query) {
  
  
  var result = [];

  query = query.trim();
  if (query.length < 1) {
    return result;
  }
  var re = new RegExp(query, 'i');
  for (var i = 0; i < data.length; ++i) {
    var pos = data[i].body.search(re);
    if (pos != -1) {
      result.push([i, pos, pos + query.length]);
    }
  }
  return result;
}

function createHtml(result) {
  var htmls = [];
  for (var i = 0; i < result.length; ++i) {
    var dataIndex = result[i][0];
    var startPos = result[i][1];
    var endPos = result[i][2];
    var url = data[dataIndex].url;
    var title = data[dataIndex].title;
    var body = data[dataIndex].body;
    htmls.push(createEntry(url, title, body, startPos, endPos));
  }
  return htmls.join('');
}

function createEntry(url, title, body, startPos, endPos) {
  return '<div class="item">' +
      '<a class="item_title" href="' + url + '">' + title + '</a>' +
      '<div class="item_excerpt">' + excerpt(body, startPos, endPos) + '</div>' +
      '</div>';
}

function excerpt(body, startPos, endPos) {
  return [
    body.substring(startPos - 30, startPos),
    '<b>', body.substring(startPos, endPos), '</b>',
    body.substring(endPos, endPos + 200)
  ].join('');
}

function showResult(html) {
  var el = document.getElementById('result');
  el.innerHTML = html;
}

function showResultCount(count, total) {
  var el = document.getElementById('resultCount');
  el.innerHTML = '<b>' + count + '</b> 件見つかりました（' + total + '件中）';
}


function searchWithHash() {
  const hash = decodeURI(location.hash.substring(1));
  search(hash);

  
  const queryElem = document.getElementById('query');
  if (queryElem.value !== hash) {
    queryElem.value = hash;
  }
}


window.addEventListener('DOMContentLoaded', searchWithHash);


window.addEventListener('hashchange', searchWithHash);
</script>
</main>


 

 
 <footer>

 	
 	<div class="site_minimap">

     
     <section id="site_minimap_text">
       <h3>◆文章</h3>
       <ul>
         <li><a href="https://degarashibanchi.github.io/articles_text/">雑記</a></li>
         <li><a href="https://degarashibanchi.github.io/articles_game/">制作記</a></li>
       </ul>
     </section>

 		
 		<section id="site_minimap_info">
 				<h3>◆リンク</h3>
 				<ul>
 					<li><a href="https://bungei-huzenkai.amebaownd.com/">文芸風前会</a></li>
 				</ul>

 		</section>

 	</div>

 </footer>

 </body>
 </html>
